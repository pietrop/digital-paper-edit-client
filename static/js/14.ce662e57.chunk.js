(this["webpackJsonp@pietrop/digital-paper-edit-client"]=this["webpackJsonp@pietrop/digital-paper-edit-client"]||[]).push([[14],{155:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n={yellow:"#ffff00",greenyellow:"#adff2f",deepskyblue:"#00bfff",deeppink:"#ff1493",aqua:"#00ffff",black:"#000000",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chocolate:"#d2691e",coral:"#ff7f50",crimson:"#dc143c",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",blue:"#0000ff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",chartreuse:"#7fff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",yellowgreen:"#9acd32",aquamarine:"#7fffd4",mediumaquamarine:"#66cdaa"},r=Object.freeze(Object.keys(n).splice(0,15)),o=[];for(var i in n)o.push({value:i,label:i,color:n[i]});var c=-1,l=r.length,s=function(){return c<l?c+=1:c=0,r[c]}},176:function(e,t,a){"use strict";var n=a(101),r=a(0),o=a.n(r),i=a(155),c=a(175),l=a.n(c),s=a(107),m=a(30),p=a(92),d=a(230),u=a(93),f=a(91),g=a(94);t.a=function(e){var t=Object(r.useState)(e.color),a=Object(n.a)(t,2),c=a[0],h=a[1],v=function(t){console.log("handleSetColor",t),h(t),e.handleColorSelectChange(t)};return o.a.createElement(s.a.Group,{controlId:"formGroupPassword"},o.a.createElement(s.a.Label,null,"Color"),o.a.createElement(m.a,null,o.a.createElement(p.a,{xs:2,sm:1,md:1,lg:1,xl:1},o.a.createElement(u.a,{onClick:function(){var e=Object(i.b)();v(e)},variant:"light",size:"sm"},o.a.createElement(f.a,{icon:g.J}))),o.a.createElement(p.a,{xs:6,sm:6,md:6,lg:6,xl:6},o.a.createElement(s.a.Control,{value:c,type:"text",placeholder:"#",onChange:function(e){if(e&&e.target&&e.target.value){var t=e.target.value,a=l.a.valid(t)?l()(t).name():t;v(a)}else e&&e.target&&""===e.target.value&&v("")}})),o.a.createElement(p.a,{xs:2,sm:2,md:2,lg:2,xl:2,style:{backgroundColor:c,border:"solid",borderWidth:"0.01em",borderColor:"grey",padding:"1em"}})),o.a.createElement(m.a,null,o.a.createElement(p.a,{xs:12,sm:12,md:12,lg:12,xl:12},o.a.createElement(s.a.Text,{className:"text-muted"},"To pick a color you can chose one at random, pick one form the list below, or type the name or hex code above."),o.a.createElement(d.GithubPicker,{width:"100%",color:c,triangle:"hide",onChangeComplete:function(e){var t=l()(e.hex).name();v(t)},colors:i.a}))))}},542:function(e,t,a){var n={"./cline.gif":543,"./line.gif":544,"./p2p.gif":545,"./point.gif":546};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=542},543:function(e,t,a){e.exports=a.p+"static/media/cline.c9d93ffa.gif"},544:function(e,t,a){e.exports=a.p+"static/media/line.8ed85f9f.gif"},545:function(e,t,a){e.exports=a.p+"static/media/p2p.8b6575a3.gif"},546:function(e,t,a){e.exports=a.p+"static/media/point.08c277d3.gif"},550:function(e,t,a){"use strict";a.r(t);var n=a(97),r=a.n(n),o=a(128),i=a(112),c=a(18),l=a(19),s=a(21),m=a(20),p=a(22),d=a(0),u=a.n(d),f=a(30),g=a(267),h=a.n(g),v=a(130),E=a(101),x=function(e){return u.a.createElement("div",{style:{width:"".concat(e.percentage,"%"),background:"red",height:"100%",borderRadius:"inherit"}})},S=function(e){return u.a.createElement("div",{onClick:e.onClick,style:{position:"relative",height:"12px",width:"100%",opacity:"1"}},u.a.createElement(x,{percentage:e.percentage}))},b=function(e,t){return e/t*100},y=function(e){var t=Object(d.useRef)(),a=Object(d.useState)(0),n=Object(E.a)(a,2),r=n[0],o=n[1],i=Object(d.useState)(),c=Object(E.a)(i,2),l=c[0],s=c[1],m=Object(d.useState)(0),p=Object(E.a)(m,2),f=p[0],g=p[1];return Object(d.useLayoutEffect)((function(){t.current&&g(t.current.offsetWidth)}),[t]),Object(d.useEffect)((function(){s(e.videoContext),l&&function e(){var t=b(l.currentTime,l.duration);o(t),requestAnimationFrame(e)}()}),[e.videoContext,l]),u.a.createElement("div",{ref:t,style:{width:"100%"}},u.a.createElement(S,{onClick:function(e){var t=e.nativeEvent.offsetX;l.currentTime=t/f*l.duration;var a=b(l.currentTime,l.duration);o(a)},percentage:r}))},w=a(93),P=a(92),k=a(91),C=a(94),T=u.a.createElement(k.a,{icon:C.C}),O=u.a.createElement(k.a,{icon:C.A}),D=u.a.createElement(k.a,{icon:C.H}),j=function(e){var t=Object(d.useState)(!1),a=Object(E.a)(t,2),n=a[0],r=a[1];return u.a.createElement(u.a.Fragment,null,u.a.createElement(P.a,{sm:6},u.a.createElement(w.a,{size:"sm",block:!0,variant:"light",onClick:n?function(){e.handlePause(),r(!1)}:function(){e.handlePlay(),r(!0)}},n?O:T)),u.a.createElement(P.a,{sm:6},u.a.createElement(w.a,{size:"sm",block:!0,variant:"light",onClick:function(){e.handleStop(),r(!1)}},D)))},A=a(523),F=a.n(A),I=function(e){var t=Object(d.useState)(),a=Object(E.a)(t,2),n=a[0],r=a[1];Object(d.useEffect)((function(){e.canvasRef&&e.canvasRef.current&&r(new F.a(e.canvasRef.current))}),[e.canvasRef]),n&&e.playlist.forEach((function(e){var t=e.type,a=e.sourceStart,r=e.start,o=e.duration,i=e.src,c=n[t](i,a);c.startAt(r),c.stopAt(r+o),c.connect(n.destination)}));var o;return u.a.createElement(u.a.Fragment,null,u.a.createElement(f.a,{className:"justify-content-center",style:{backgroundColor:"black"}},u.a.createElement("canvas",{ref:e.canvasRef,width:e.width,height:.5625*e.width})),u.a.createElement(f.a,{className:"justify-content-center",style:{backgroundColor:"lightgrey"}},u.a.createElement(y,{videoContext:n})),u.a.createElement(f.a,{style:{marginTop:"0.4em"}},u.a.createElement(j,{handlePlay:n?function(){return n.play()}:function(){return console.log("handlePlay")},handlePause:n?function(){return n.pause()}:function(){return console.log("handlePause")},handleStop:n?function(){return n.pause(),void r((function(e){return e.currentTime=0,e}))}:function(){return console.log("handleStop")}})),u.a.createElement(f.a,{className:"justify-content-center"},"Total duration: ",n?(o=n.duration,new Date(1e3*o).toISOString().substr(11,8)):"00:00:00"))};I.defaultProps={playlist:[]};var L=I,N=function(e){var t=Object(d.useRef)();return u.a.createElement(L,{width:e.width,canvasRef:t,playlist:e.playlist})};N.defaultProps={playlist:[]};var R=N,q=a(140),J=a(266),_=a(270),W=a(196),X=a(152),M=a(524),U=a.n(M),V=a(526),B=a.n(V),z=a(534),G=a.n(z),H=a(535),K=a.n(H),Q=a(536),Y=a.n(Q),$=a(537),Z=a.n($),ee=a(88);var te=function(e){var t=e.onClick,a=e.title,n=e.text,r=e.tootlipDelay;return u.a.createElement(W.a,{placement:"left",delay:r,overlay:u.a.createElement(_.a,null,a)},u.a.createElement(q.a.Item,{variant:"light",eventKey:"1",onClick:t},n))};function ae(e){return{start:parseFloat(e.dataset.start),end:parseFloat(e.dataset.end),text:e.innerText,speaker:e.dataset.speaker,transcriptId:e.dataset.transcriptId}}var ne=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end),transcriptId:t[0].dataset.transcriptId,speaker:t[0].dataset.speaker,words:Array.from(t).map((function(e){return ae(e)}))};var a=window.getSelection().anchorNode.parentElement;return"words"===a.className&&{start:parseFloat(a.dataset.start),end:parseFloat(a.dataset.end),transcriptId:a.dataset.transcriptId,speaker:a.dataset.speaker,words:[ae(a)]}}return!1},re=function(e){var t=e[0];return 0===e.filter((function(e){return e.speaker!==t.speaker})).length},oe=function(e){if(re(e))return e;var t=e[0].speaker,a=[],n=[];return e.forEach((function(r,o){r.speaker===t?a.push(r):(n.push(a),(a=[]).push(r),t=r.speaker),o===e.length-1&&n.push(a)})),n},ie=a(108),ce=a(120),le=a(540),se=a(166),me=function(e,t){console.log("edlJson",e.title);var a=e.title,n=new le.Document({creator:"Test",description:"Test Description",title:a}),r=[];return e.events.forEach((function(e){if("title"===e.type)r.push(new le.Paragraph({text:e.text,heading:le.HeadingLevel.HEADING_1,spacing:{after:200}}));else if("voice-over"===e.type)r.push(new le.Paragraph({children:[new le.TextRun({text:"Voice Over:\t",italics:!1,bold:!0}),new le.TextRun({text:"".concat(e.text)})],spacing:{after:200}}));else if("note"===e.type)r.push(new le.Paragraph({children:[new le.TextRun({text:"Notes:\t",italics:!0,bold:!0}),new le.TextRun({text:"".concat(e.text),italics:!0})],spacing:{after:200}}));else if("paper-cut"===e.type){var a=e.words.map((function(e){return e.text})).join(" ");r.push(new le.Paragraph({children:[new le.TextRun({text:"".concat(e.speaker,"\t"),bold:!0,allCaps:!0}),new le.TextRun({text:"".concat(a)})],spacing:{after:100}})),t&&r.push(new le.Paragraph({children:[new le.TextRun({text:"".concat(e.clipName,"\t [").concat(Object(se.shortTimecode)(e.start)," - ").concat(Object(se.shortTimecode)(e.end),"]"),size:18})],spacing:{after:200}}))}return null})),n.addSection({properties:{},children:[new le.Paragraph({text:a,heading:le.HeadingLevel.TITLE,alignment:le.AlignmentType.CENTER})].concat(r)}),new Promise((function(e,t){return le.Packer.toBlob(n).then((function(t){console.log(t),e(t),console.log("Document created successfully")})).catch((function(e){t(e)}))}))},pe=a(110),de=a(107),ue=a(541),fe=a(176);var ge=function(e){var t=Object(d.useState)(!1),n=Object(E.a)(t,2),r=n[0],o=n[1],i=Object(d.useState)("cline"),c=Object(E.a)(i,2),l=c[0],s=c[1],m=Object(d.useState)("blue"),p=Object(E.a)(m,2),f=p[0],g=p[1],h=function(){return o(!1)};return u.a.createElement(u.a.Fragment,null,u.a.createElement(q.a.Item,{variant:"light",eventKey:"1",onClick:function(){return o(!0)}},e.text),u.a.createElement(pe.a,{show:r,onHide:h},u.a.createElement(pe.a.Header,{closeButton:!0},u.a.createElement(pe.a.Title,null,"Export audio as video waveform")),u.a.createElement(pe.a.Body,null,u.a.createElement(de.a.Group,{controlId:"exampleForm.ControlSelect1"},u.a.createElement(de.a.Label,null,"Select waveform style"),u.a.createElement(de.a.Control,{as:"select",onChange:function(e){var t=e.target.value;console.log("handleSetWaveFormMode",t),s(t)}},u.a.createElement("option",{value:"cline"},"cline"),u.a.createElement("option",{value:"point"},"point"),u.a.createElement("option",{value:"p2p"},"p2p"),u.a.createElement("option",{value:"line"},"line"))),u.a.createElement(ue.a,{src:a(542)("./".concat(l,".gif")),alt:"loading...",fluid:!0}),u.a.createElement(fe.a,{color:f,handleColorSelectChange:function(e){console.log("handleColorSelectChange",e),g(e)}})),u.a.createElement(pe.a.Footer,null,u.a.createElement(w.a,{variant:"secondary",onClick:h},"Close"),u.a.createElement(w.a,{variant:"primary",onClick:function(){e.handleExportAudioPreviewWithVideoWaveform({waveFormMode:l,waveFormColor:f}),o(!1)}},"Submit"))))},he=u.a.lazy((function(){return Promise.all([a.e(18),a.e(19)]).then(a.bind(null,599))})),ve={type:"insert-point",text:"Insert Point to add selection"},Ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(m.a)(t).call(this,e))).mouseUpListener=function(){if(window.getSelection||document.selection){var e=ne();e&&(a.setState({tmpSelection:e}),a.state.isAdvancedSelect&&a.handleAddTranscriptSelectionToProgrammeScript())}},a.componentDidMount=function(){ie.a.getPaperEdit(a.props.projectId,a.props.papereditId).then((function(e){var t=e.programmeScript;t.elements.push(ve),a.setState({programmeScript:t})})),document.addEventListener("mouseup",a.mouseUpListener)},a.componentWillUnmount=function(){try{document.removeEventListener("mouseup",a.mouseUpListener)}catch(e){console.error("error removing listener mouseup",e)}},a.handleProgrammeScriptOrderChange=function(e){a.setState((function(t){var a=t.programmeScript;return a.elements=e,{programmeScript:a}}),(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview()}))},a.handleDeleteProgrammeScriptElement=function(e){a.setState((function(t){var a=t.programmeScript,n=e,r=a.elements;return r.splice(n,1),a.elements=r,{programmeScript:a}}),(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview()}))},a.handleEditProgrammeScriptElement=function(e){var t=a.state.programmeScript,n=t.elements,r=n[e],o=prompt("Edit",r.text);o&&(r.text=o,n[e]=r,t.elements=n,a.setState({programmeScript:t},(function(){a.handleSaveProgrammeScript()})))},a.handleAddTranscriptElementToProgrammeScript=function(e,t){console.log("handleAddTranscriptElementToProgrammeScript",e,t);var n=a.state.programmeScript,r=a.state.programmeScript.elements;if("title"===e||"note"===e||"voice-over"===e){var o=prompt("Add some text for a section title","Some place holder text");if(o){var i=0;i=t||0===t?t+1:a.getIndexPositionOfInsertPoint();var c={id:h()(),index:r.length,type:e,text:o};r.splice(i,0,c),n.elements=r,a.setState({programmeScript:n},(function(){a.handleSaveProgrammeScript()}))}}},a.getIndexPositionOfInsertPoint=function(){var e=a.state.programmeScript.elements,t=e.find((function(e){return"insert-point"===e.type}));return e.indexOf(t)},a.handleAddTranscriptSelectionToProgrammeScriptTmpSave=function(e){var t=a.state.tmpSelection;if(t&&t.transcriptId&&t.speaker){var n=a.state.programmeScript,r=n.elements,o=0;if(o=e||0===e?e+1:a.getIndexPositionOfInsertPoint(),re(t.words)){var i={id:h()(),index:r.length,type:"paper-cut",start:t.start,end:t.end,speaker:t.speaker,words:t.words,transcriptId:t.transcriptId,labelId:[]};r.splice(o,0,i),n.elements=r}else{oe(t.words).reverse().forEach((function(e){var t={id:h()(),index:r.length,type:"paper-cut",start:e[0].start,end:e[e.length-1].end,speaker:e[0].speaker,words:e,transcriptId:e[0].transcriptId,labelId:[]};r.splice(o,0,t),n.elements=r}))}a.setState({programmeScript:n},(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview()}))}else alert("Select some text in the transcript to add to the programme script")},a.handleAddTranscriptSelectionToProgrammeScript=function(e,t){var n=ne();if(n){var r=a.state.programmeScript,o=r.elements,i=0;if(i=t||0===t?t+1:a.getIndexPositionOfInsertPoint(),re(n.words)){var c={id:h()(),index:o.length,type:"paper-cut",start:n.start,end:n.end,speaker:n.speaker,words:n.words,transcriptId:n.transcriptId,labelId:[]};o.splice(i,0,c),r.elements=o}else{oe(n.words).reverse().forEach((function(e){var t={id:h()(),index:o.length,type:"paper-cut",start:e[0].start,end:e[e.length-1].end,speaker:e[0].speaker,words:e,transcriptId:e[0].transcriptId,labelId:[]};o.splice(i,0,t),r.elements=o}))}a.setState({programmeScript:r},(function(){a.handleSaveProgrammeScript(),a.handleUpdatePreview(),window.getSelection().collapse(document,0)}))}else alert("Select some text in the transcript to add to the programme script")},a.getSequenceJsonEDL=function(){var e,t={title:a.state.programmeScript.title,events:[]},n=a.state.programmeScript.elements.map((function(e){if("paper-cut"===e.type){var t=a.props.transcripts.find((function(t){return t.id===e.transcriptId})),n=25;return t.metadata&&t.metadata.fps&&"NA"!==t.metadata.fps&&(n=t.metadata.fps),{startTime:e.start,endTime:e.end,reelName:t.metadata?t.metadata.reelName:"NA",clipName:"".concat(t.clipName),fps:n,offset:t.metadata?t.metadata.timecode:"00:00:00:00",sampleRate:t.metadata?t.metadata.sampleRate:"16000"}}return null})).filter((function(e){return null!==e})).map((function(e,t){return e.id=t+1,e}));return(e=t.events).push.apply(e,Object(i.a)(n)),t},a.getSequenceJsonForFfmpegRemix=function(){return a.state.programmeScript.elements.map((function(e){if("paper-cut"===e.type){console.log(e);var t=a.props.transcripts.find((function(t){return t.id===e.transcriptId}));return{start:parseFloat(e.start),end:parseFloat(e.end),source:"".concat(t.url)}}return null})).filter((function(e){return null!==e}))},a.handleExportEDL=function(){var e=a.getSequenceJsonEDL(),t=new U.a(e);Y()(t.compose(),"".concat(a.state.programmeScript.title,".edl"),"text/plain")},a.handleExportADL=function(){var e=a.getSequenceJsonEDL(),t=e.events[0],n=25;t.fps&&"NA"!==t.fps&&(n=t.fps);var r=B()({projectOriginator:"Digital Paper Edit",edits:e.events.map((function(e){return{start:e.startTime,end:e.endTime,clipName:e.clipName,label:""}})),sampleRate:t.sampleRate,frameRate:n,projectName:e.title});Y()(r,"".concat(a.state.programmeScript.title,".adl"),"text/plain")},a.handleExportFCPX=function(){var e=a.getSequenceJsonEDL(),t=G()(e);Y()(t,"".concat(a.state.programmeScript.title,".fcpxml"),"text/plain")},a.handleExportXML=function(){var e=a.getSequenceJsonEDL(),t=K()(e);Y()(t,"".concat(a.state.programmeScript.title,".xml"),"text/plain")},a.getProgrammeScriptJson=function(){var e,t={title:a.state.programmeScript.title,events:[]},n=a.state.programmeScript.elements.map((function(e){if("paper-cut"===e.type){var t=a.props.transcripts.find((function(t){return t.id===e.transcriptId})),n=25;return t.metadata&&t.metadata.fps&&"NA"!==t.metadata.fps&&(n=t.metadata.fps),Object(o.a)({},e,{src:t.url,startTime:e.start,endTime:e.end,reelName:t.metadata?t.metadata.reelName:"NA",clipName:"".concat(t.clipName),fps:n,sampleRate:t.metadata?t.metadata.sampleRate:"16000",offset:t.metadata?t.metadata.timecode:"00:00:00:00"})}return e})).filter((function(e){return null!==e})).map((function(e,t){return e.id=t+1,e}));return(e=t.events).push.apply(e,Object(i.a)(n)),t},a.programmeScriptJsonToText=function(e){var t="# ".concat(e.title,"\n\n"),a=e.events.map((function(e){return"title"===e.type?"## ".concat(e.text):"voice-over"===e.type?"_".concat(e.text,"_"):"note"===e.type?"[ ".concat(e.text,"]"):"paper-cut"===e.type?"".concat(Z.a.fromSeconds(e.startTime),"\t").concat(Z.a.fromSeconds(e.endTime),"\t").concat(e.speaker,"\t-\t").concat(e.clipName,"     \n").concat(e.words.map((function(e){return e.text.replace(/'/,"'")})).join(" ")):null}));return"".concat(t).concat(a.join("\n\n"))},a.programmeScriptJsonToTextPaperCutsOnly=function(e){var t=e.events.map((function(e){return"paper-cut"===e.type?"".concat(e.words.map((function(e){return e.text.replace(/'/,"'")})).join(" ")):null}));return"".concat(t.filter((function(e){return null!==e})).join("\n\n"))},a.handleExportJson=function(){var e=a.getProgrammeScriptJson(),t=JSON.stringify(e,null,2);Y()(t,"".concat(a.state.programmeScript.title,".json"),"text/plain")},a.handleCepExportSequence=function(){var e={edlJson:{events:a.getProgrammeScriptJson().events.filter((function(e){return"paper-cut"===e.type})).map((function(e){return delete e.words,e})),title:a.state.programmeScript.title}},t="$._PPP.create_sequence_from_paper_edit('"+JSON.stringify(e)+"')";window.__adobe_cep__.evalScript(t,(function(e){console.info("done exporting sequence")}))},a.handleExportTxt=function(){var e=a.getProgrammeScriptJson(),t=a.programmeScriptJsonToText(e);Y()(t,"".concat(a.state.programmeScript.title,".txt"),"text/plain")},a.handleExportTxtOnyPaperCuts=function(){var e=a.getProgrammeScriptJson(),t=a.programmeScriptJsonToTextPaperCutsOnly(e);Y()(t,"".concat(a.state.programmeScript.title,".txt"),"text/plain")},a.handleExportDocx=function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.getProgrammeScriptJson(),!1,n.next=4,r.a.awrap(me(e,!1));case 4:t=n.sent,Y()(t,"".concat(a.state.programmeScript.title,".docx"),"text/docx");case 6:case"end":return n.stop()}}))},a.handleExportDocxWithClipReference=function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=a.getProgrammeScriptJson(),!0,n.next=4,r.a.awrap(me(e,!0));case 4:t=n.sent,Y()(t,"".concat(a.state.programmeScript.title,".docx"),"text/docx");case 6:case"end":return n.stop()}}))},a.handleUpdatePreview=function(){var e=0,t=a.state.programmeScript.elements.map((function(t){if("paper-cut"===t.type){var n=a.props.transcripts.find((function(e){return e.id===t.transcriptId})),r=t.end-t.start,o={type:"video",start:e,sourceStart:t.start,duration:r,src:n.url};return e+=r,o}return null})).filter((function(e){return null!==e}));a.setState({resetPreview:!0},(function(){a.setState({resetPreview:!1,playlist:t})})),a.setState({playlist:t})},a.handleDoubleClickOnProgrammeScript=function(e){e.target.className},a.handleSaveProgrammeScript=function(){var e=a.state.programmeScript,t=Object(o.a)({},e);if(t){var n=Object(i.a)(t.elements),r=n.find((function(e){return"insert-point"===e.type}));if(r){var c=n.indexOf(r);n.splice(c,1)}t.elements=n,ie.a.updatePaperEdit(a.props.projectId,a.props.papereditId,t).then((function(e){"ok"===e.status&&a.setState({lastSaved:new Date})}))}},a.handleChangeInsertPointPosition=function(e){var t=a.state.programmeScript,n=Object(o.a)({},t);if(n){var r=Object(i.a)(n.elements),c=r.find((function(e){return"insert-point"===e.type})),l=Object(o.a)({},ve);if(r.splice(e+1,0,l),c){var s=r.indexOf(c);r.splice(s,1)}n.elements=r,ie.a.updatePaperEdit(a.props.projectId,a.props.papereditId,n).then((function(e){"ok"===e.status&&a.setState({lastSaved:new Date,programmeScript:n},(function(){}))}))}},a.handleAdvancedSelectCheckbox=function(e){var t=e.target;a.setState({isAdvancedSelect:t.checked})},a.handleDeleteProgrammeScriptContent=function(){if(confirm("Are you usure you want to delete the content of your programme script?")){var e=a.state.programmeScript,t=Object(o.a)({},e);t.elements=[Object(o.a)({},ve)],ie.a.updatePaperEdit(a.props.projectId,a.props.papereditId,t).then((function(e){"ok"===e.status&&a.setState({lastSaved:new Date,programmeScript:t},(function(){a.handleUpdatePreview()}))}))}else alert("ok no worries, nothing changed")},a.handleExportVideoPreview=function(){var e=a.getSequenceJsonForFfmpegRemix(),t=a.state.programmeScript.title,n=(new Date).toLocaleString().replace(/\//g,"-").replace(/, /g,"_").replace(/:/g,".").replace(/ /g,""),r="".concat(t,"_").concat(n,".mp4");ie.a.exportVideo(e,r).then((function(e){console.log("exported",e)}))},a.handleExportAudioPreview=function(){var e=a.getSequenceJsonForFfmpegRemix(),t=a.state.programmeScript.title,n=(new Date).toLocaleString().replace(/\//g,"-").replace(/, /g,"_").replace(/:/g,".").replace(/ /g,""),r="".concat(t,"_").concat(n,".wav");ie.a.exportAudio(e,r,!1).then((function(e){console.log("exported",e)}))},a.handleExportAudioPreviewWithVideoWaveform=function(e){var t=e.waveFormMode,n=e.waveFormColor,r=a.getSequenceJsonForFfmpegRemix(),o=a.state.programmeScript.title,i=(new Date).toLocaleString().replace(/\//g,"-").replace(/, /g,"_").replace(/:/g,".").replace(/ /g,""),c="".concat(o,"_").concat(i,".mp4");ie.a.exportAudio(r,c,!0,t,n).then((function(e){console.log("exported",e)}))},a.state={lastSaved:new Date,programmeScript:null,resetPreview:!1,isAdvancedSelect:!1,playlist:[]},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=!!window.matchMedia("(max-width: 767px)").matches;return u.a.createElement(u.a.Fragment,null,u.a.createElement(v.a,{style:{}},u.a.createElement(v.a.Body,{style:{padding:"1em",paddingTop:"0em",paddingBottom:"0.6em"}},this.state.resetPreview?null:u.a.createElement(R,{playlist:this.state.playlist,width:300})),u.a.createElement(v.a.Body,{style:{paddingTop:"0px",paddingBottom:"0.6em"}},u.a.createElement(f.a,{noGutters:!0},u.a.createElement(X.a,{style:{width:"100%"},vertical:t,block:!0},u.a.createElement(W.a,{placement:"top",delay:3e3,overlay:u.a.createElement(_.a,null,"To add a text selection, select text in the transcript, then click this button to add it to the programme script, at the orange insert point/")},u.a.createElement(w.a,{variant:"light",size:"sm",onClick:this.handleAddTranscriptSelectionToProgrammeScript},u.a.createElement(k.a,{icon:C.D})," Selection")),u.a.createElement(W.a,{placement:"top",delay:3e3,overlay:u.a.createElement(_.a,null,"Advanced selection - check this box to auto copy across transcript selections to insert point in programme script")},u.a.createElement(w.a,{variant:"light",style:{cursor:"default"}},u.a.createElement("input",{style:{cursor:"pointer"},name:"advancedSelect",type:"checkbox",checked:this.state.isAdvancedSelect,onChange:this.handleAdvancedSelectCheckbox})," ",u.a.createElement("small",{className:"text-secondary",style:{marginBottom:"0em"}},"Auto copy selections"))),u.a.createElement(J.a,{as:X.a,variant:"light",title:u.a.createElement(k.a,{icon:C.x})},u.a.createElement(te,{tootlipDelay:3e3,onClick:function(){e.handleAddTranscriptElementToProgrammeScript("title")},title:"Add a title header element to the programme script",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.t})," Heading")}),u.a.createElement(te,{tootlipDelay:3e3,onClick:function(){e.handleAddTranscriptElementToProgrammeScript("voice-over")},title:"Add a title voice over element to the programme script",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.y})," Voice Over")}),u.a.createElement(te,{tootlipDelay:3e3,onClick:function(){e.handleAddTranscriptElementToProgrammeScript("note")},title:"Add a note element to the programme script",text:u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{icon:C.G})," Note")})),u.a.createElement(W.a,{placement:"top",delay:3e3,overlay:u.a.createElement(_.a,null,"update programme script audio/video preview")},u.a.createElement(w.a,{variant:"light",onClick:this.handleUpdatePreview},u.a.createElement(k.a,{icon:C.I}))),u.a.createElement(J.a,{as:X.a,variant:"light",title:u.a.createElement(k.a,{icon:C.F})},"cep"===Object(ce.a)()?u.a.createElement(u.a.Fragment,null,u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleCepExportSequence,title:"export the programme script as a sequence in Adobe Premiere",text:u.a.createElement(u.a.Fragment,null,"Premiere - Sequence ",u.a.createElement(k.a,{icon:C.w}))})):u.a.createElement(u.a.Fragment,null,u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportEDL,title:"export EDL, edit decision list, to import the programme script as a sequence in video editing software - Avid, Premiere, Davinci Resolve, for FCPX choose FCPX XML",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.Q})," EDL - Video ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(te,{tootlipDelay:3e3,title:"export FCPX XML, to import the programme script as a sequence in Final Cut Pro X, video editing software",onClick:this.handleExportFCPX,text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.Q})," FCPX ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(q.a.Divider,null),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportADL,title:"export ADL, audio decision list, to import the programme script as a sequence in audio editing software such as SADiE",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.u})," ADL - Audio ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportXML,title:"export XML, audio decision list, to import the programme script as a sequence in audio editing software such as Audition",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.u})," XML - Audition ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(q.a.Divider,null),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportTxt,title:"export Text, export the programme script as a text version",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.k})," Text File ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportTxtOnyPaperCuts,title:"export Text, export only the text selection in the programme script as a text version",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.k})," Text File (only text selection) ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportDocx,title:"export docx, export the programme script as a word document",text:u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{icon:C.o})," Word Document ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportDocxWithClipReference,title:"export docx, export the programme script as a word document, with clip name and timecode references, for text selections",text:u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{icon:C.o})," Word Doc (with ref) ",u.a.createElement(k.a,{icon:C.w}))}),"electron"===Object(ce.a)()?u.a.createElement(u.a.Fragment,null,u.a.createElement(q.a.Divider,null),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportVideoPreview,title:"Export mp4 video preview - Experimental feature, at the moment you cannot combine audio and video in the same export.",text:u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{icon:C.n})," Video (mp4) ",u.a.createElement(k.a,{icon:C.q})," ",u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportAudioPreview,title:"Export wav audio preview - Experimental feature, at the moment you cannot combine audio and video in the same export.",text:u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{icon:C.l})," Audio (wav) ",u.a.createElement(k.a,{icon:C.q}),u.a.createElement(k.a,{icon:C.w}))}),u.a.createElement(q.a.Divider,null),u.a.createElement(ge,{TOOLTIP_DEPLAY_IN_MILLISECONDS:3e3,handleExportAudioPreviewWithVideoWaveform:this.handleExportAudioPreviewWithVideoWaveform,title:"Export audio preview as video with animated wave form - Experimental feature, at the moment you cannot combine audio and video in the same export.",text:u.a.createElement(u.a.Fragment,null,u.a.createElement(k.a,{icon:C.l})," Animated Waveform (mp4) ",u.a.createElement(k.a,{icon:C.q}),u.a.createElement(k.a,{icon:C.w}))})):null,u.a.createElement(q.a.Divider,null),u.a.createElement(te,{tootlipDelay:3e3,onClick:this.handleExportJson,title:"export Json, export the programme script as a json file",text:u.a.createElement(u.a.Fragment,null," ",u.a.createElement(k.a,{icon:C.m})," Json ",u.a.createElement(k.a,{icon:C.w}))}))),u.a.createElement(W.a,{placement:"top",overlay:u.a.createElement(_.a,null," Last Saved at ".concat(this.state.lastSaved.toLocaleString()))},u.a.createElement(w.a,{variant:"light",disabled:!0},u.a.createElement("small",{className:"text-secondary",style:{marginBottom:"0em"}},"".concat(this.state.lastSaved.toLocaleTimeString())))),u.a.createElement(W.a,{placement:"top",delay:3e3,overlay:u.a.createElement(_.a,null,"Delete programme script content.")},u.a.createElement(w.a,{variant:"light",onClick:this.handleDeleteProgrammeScriptContent},u.a.createElement(k.a,{icon:C.N})))))),u.a.createElement("hr",{style:{margin:"0px"}}),u.a.createElement(v.a.Body,{style:{padding:"0px"}},u.a.createElement("article",{style:{height:"55vh",overflow:"scroll",padding:"1em"},onDoubleClick:this.handleDoubleClickOnProgrammeScript},this.state.programmeScript?u.a.createElement(d.Suspense,{fallback:u.a.createElement(u.a.Fragment,null,u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}),u.a.createElement(ee.a,{variant:"text"}))},u.a.createElement(he,{programmeScriptElements:this.state.programmeScript.elements,handleProgrammeScriptOrderChange:this.handleProgrammeScriptOrderChange,handleDeleteProgrammeScriptElement:this.handleDeleteProgrammeScriptElement,handleEditProgrammeScriptElement:this.handleEditProgrammeScriptElement,handleAddTranscriptElementToProgrammeScript:this.handleAddTranscriptElementToProgrammeScript,handleAddTranscriptSelectionToProgrammeScriptTmpSave:this.handleAddTranscriptSelectionToProgrammeScriptTmpSave,handleChangeInsertPointPosition:this.handleChangeInsertPointPosition})):null))))}}]),t}(d.Component);t.default=Ee}}]);
//# sourceMappingURL=14.ce662e57.chunk.js.map